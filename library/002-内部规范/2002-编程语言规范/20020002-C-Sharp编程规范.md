# C# 编程规范
> 维护人员: 潘景福    
> 创建时间: 2016-12-19    
> **不管有多少人共同参与同一项目，一定要确保每一行代码都像是同一个人编写的。**

[TOC]

## 命名规则
### 1. 命名规范

> Pascal 大小写形式——所有单词第一个字母大写，其他字母小写。
>
> Camel 大小写形式——除了第一个单词，所有单词第一个字母大写，其他字母小写。

* 类名使用 Pascal 大小写形式

```c#
public class HelloWorld
{
}
```

* 方法使用 Pascal 大小写形式

```c#
public class HelloWorld
{
    public void SayHello(string name)
    {
    }
}
```

* 常量使用 Pascal 大小写形式    

```c#
public class HelloWorld
{
    public const int MaxValue = 100;
}
```

* 变量和方法参数使用 Camel 大小写形式    

```c#
public class HelloWorld
{
    int totalCount = 0;

    void SayHello(string name)
    {
        string fullMessage = "Hello " + name;
    }
}
```

* 不要使用缩写（用 name, address, salary，而不是 nam, addr, sal），也不要使用前缀

```c#
// 好的风格
int totalCount = 0;
string fullMessage = "";

// 坏的风格
int nTotalCount = 0;
int m_totalCount = 0;
int tc = 0;
```

* 不要使用单个字母的变量名 i, n, x 等（用于迭代的变量例外）  

```c#
for (int i = 0; i < length; i++)
{
}
```

### 2. 代码缩进和间隔

* 缩进用Tab，而不是 Space 空格。
* 花括号 { } 需与外层代码对齐。

```c#
void SayHello(bool isDone, string name)
{
    // 好的风格
    if (isDone)
    {
        // Do something...
    }

    // 坏的风格
    if (isDone)
  {
        // Do something...
  }

    // 坏的风格
    if (isDone)
      {
        // Do something...        
      }
}
```

* 用一个空行来分开代码的逻辑分组。

```c#
Point point1 = new Point();
point1.X = 100;
point1.Y = 200;

// 不同逻辑代码组前要空一行
Point point2 = new Point();
point2.X = 300;
point2.Y = 400;
```

* 花括号需要独立一行，而不是与之前的语句在同一行

```c#
// 好的风格
if (isDone)
{
    // Do something...
}

// 坏的风格
if (isDone) {
    // Do something...
}
```

* 运算符前后都要空一格    

```C#
// 好的风格
if (showResult == true)
{
    for (int i = 0; i < 10; i++)
    {
        //
    }
}

// 坏的风格
if (showResult==true)
{
    for (int i=0;i<10;i++)
    {
        //
    }
}
```


### 3.注释    

* 类和方法可以在 Visual Studio 里通过 /// 自动产生注释格式

```c#
/// <summary>
/// 这是方法说明
/// </summary>
/// <param name="isDone">这是 isDone 的说明</param>
/// <param name="name">这是 name 的说明</param>
void SayHello(bool isDone, string name)
{
}
```
* 注释应仅在需要的地方注释，而不是每行代码每个变量声明都做注释，变量名自身能通过名称确定意义，会使代码的可读性很强而不需要注释

```c#
// 这里是逻辑一的注释
if (isDone)
{
    // Do something
}

//  打印一个点
Point point = new Point();
point.X = 1;
point.Y = 2;
PrintPoint(point);
```

### 4.异常处理

* 不要捕捉了异常却什么都不做，如果隐藏了异常你将永远不知道发生了什么。
* 发生异常时，要给出友好的消息给用户，但要精确记录异常的细节，包括发生时间、关联方法、类名。
* 只捕捉特定的异常，而不是一般的异常   

```c#

// 好的方式
string ReadFromFile(string fileName)
{
    try
    {
        // read from file.
    }
    catch (FileIOException ex)
    {
        // 记录异常日志
        logger.Error(ex);
        // 基于场景决定是否要重新抛出异常
        throw;
    }
}

// 坏的方式
string ReadFromFile(string fileName)
{
    try
    {
        // read from file.
    }
    catch (Exception ex)
    {
        // 捕捉常规异常，我们就无法知道是文件处理异常还是其他类型的异常

        // 这里隐藏了异常
        // 这种情况下，无法知道有异常发生
        return "";
    }
}
```

* 不必在所有方法中捕捉一般异常，让程序崩溃吧，这可以帮助你在开发期间发现大多数错误。
* 在应用程序级（线程级）处理所有一般的异常，此时应该捕获到异常，给用户提示，并在程序关闭或用户选择“忽略并继续”之前记录异常
* 不必在每个方法中都用 try-catch，仅当特定的异常可能发生时才使用，比如读写文件时处理异常 FileIOException。
* 别写太大的 try-catch 块，如果需要为每个执行的任务编写单独的 try-catch 块，这可以帮你找到具体的异常位置，并发出特定的消息或者执行特定的异常处理



## 良好的编程习惯     

* 避免使用大文件，如果一个文件的代码超过 500 行，应考虑将代码分到不同的类中。
* 一个典型的方法，代码在 1~25 行之间，如果一个方法代码超过 25 行，应考虑将其分解为不同的方法
* 方法命名应尽可能的让它的含义一目了然   

```c#
// 好的方法命名
void SavePhoneNumber(string phoneNumber)
{
    // Save the phone number.
}

// 坏的方法命名
// This method will save the phone number.
void SaveData(string phoneNumber)
{
    // Save the phone number.
}
```

* 一个方法只完成一个任务，不要把多个任务组合到一个方法中
* 使用 C# 的特有类型，而不是 System 命名空间下定义的类型

```c#
// 好的
int age;
string name;
object contactInfo;

// 坏的
Int32 age;
String name;
Object contactInfo;
```

* 避免在程序中使用固定数值，用常量代替    

```c#
// 好的
const int OrganizeID = 3012;

if (fromID == OrganizeID)
{
}

// 坏的
if (fromID == 3102)
{
}
```

* 必要时使用 enum 枚举，而不是数字或字符串来指示离散值    

```c#
// 好的方式
enum OrderStatus
{
    NewOrder = 0,
    Confirmed = 1,
    Paid = 2
}

switch(order.Status)
{
    case OrderStatus.NewOrder:
        break;
    case OrderStatus.Confirmed:
        break;
    case OrderStatus.Paid:
        break;
}

// 坏的方式
switch(order.Status)
{
    case 0:
        break;
    case 1:
        break;
    case 2:
        break;
}
```


## 修订记录

> | 版本   | 日期         | 说明   | 修订人  |
> | :----: | :----------: | :---- | :---- |
> | 0.1  | 2016-12-19 | 初版   | 潘景福  |
