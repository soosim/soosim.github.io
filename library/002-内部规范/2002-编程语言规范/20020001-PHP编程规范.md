# PHP 编程规范
> 维护人员: Tony Wang    
> 创建时间: 2016-12-06  

---
> 不管有多少人共同参与同一项目，一定要确保每一行代码都像是同一个人编写的。

## 注释的规则
1.  **源代码开头注释**  
  在每一个源代码的开头部分，要包含文件的编号、简要说明、作者和最后修改日期。具体例子如下所示:
  ```php
  // +----------------------------------------------------------------------
  // | 系统启动引导程序
  // +----------------------------------------------------------------------
  // | Copyright (c) 2017年 如此生活. All rights reserved.
  // +----------------------------------------------------------------------
  // | File:   bootstrap.php
  // |
  // | Author: Tony Wang <tony@iapp.hk>
  // | Created:   2016-04-21
  // +----------------------------------------------------------------------
  ```

1.  **函数开头注释**  
  建议在函数的开头的注释如下所示:
  ```php
  /**
  * 发送数据到支付接口
  * @author tony wang 2016-12-12
  *
  * @access public
  * @param $orders_id int 订单编号
  * @param $amount decimal  金额
  * @param $reason string  原因
  * @param $remark string  备注
  * @return bool 返回
  */
  ```
  该函数注释主要是对函数传入的形参和回传值进行说明，并简要说明该函数的作用。

1. **函数体内部注释**  
  函数体内内的注释统一采用重新起行，以//开头， 例如：
  ```php
  // 确定数组中参数的值是否为空
  if (empty($params['equation'])) {
    show_message(“xxxxxxx”);
    return;
  }
  ```

## 变量名的命名规则
1. **传递参数命名**  
如果是引用传递的参数，要求参数名以 r_ 开头，以方便清晰分辨

1. **函数返回值命名**  
一般采用 $ret开头 做为函数返回值中间处理的载体

1. **函数局部变量命名**  
该部分主要定义局部变量的命名规则。  
***全小写，下划线分隔，例如：$user_id。***  
>由于PHP对函数变量的使用是松散的，这样在使用变量上比较方便，可以不用考虑变量的类型和变量的声明，但是在也会对程序的阅读性和调试带来一定的困惑，所以建议在使用变量前首先声明变
>量，同时遵循以下的命名规则(匈牙利命名法,开头小写字母标示变量类型,后续都采用首字母大写)：  
  + 整数变量以i开头，例如: int $i_pad；
  + 字符串变量以s开头, 例如: string $s_pad；
  + Boolean类型的变量以b开头，例如: bool $b_pad;
  + 数组类型的变量以ar开头， 例如: int $ar_pad[];
  + 浮点数类型的变量有三种float, double, real, 统一以f开头，例如: float $f_pad;
  + 可变类型变量以mix开头,例如: mix_pad;

1. **全局变量命名**   
  该部分主要是定义全局变量的命名规则。  
  在PHP中全局变量的使用有以下几种方式:  
    +	使用$GLOBALS这个数组；
    +	使用global这个关键字来申明；
  无论是采用上面的那种方式(建议使用第二种方法)，全局变量名均以大写字母开头，如下所示:
  ```php
  $GLOBALS[“global_path”] = “global”;
  或者
  global $global_path
  $global_path = “global”;
  ```

1. **常量命名**
  该部分主要是定义常量的命名规则。  
  在PHP中定义常量由以下几种方式:
    +	使用DEFINE 关键字来定义；
    +	使用static 关键字来定义(php5之后)；  
    无论采用上面的那种方式（建议使用第一种方法）, 常量名全部大写，中间允许用下划线分隔单词，一般建议常量开头以CONST开头，随后第一个单词是便于分类的类别名称例如：
  ```php
  DEFINE(“CONST_MSDB_USER_PORT”,”1433”);
  或者
  static final int CONST_MSDB_USER_PORT =1433;
  ```

## 函数名的命名规则
  函数名的命名采用Camel(骆驼)命名法:大小写混合的方式，第一个单词的第一个字母小写，其后单词的首个字母大写。例如:
  ```php
  function run();
  function runToFront();
  function getBackground();
  ```
  通常每个函数都是执行一个动作，所以对它的命名应该清楚的说明它是做什么的：
  > 用check_for_errors() 代替 error_check(),   
  > 用dump_data_to_file() 代替data_file()。  

  有时候后缀名是很用的:     

  | 后缀编码    | 说明     |
  | :------------- | :------------- |
  | max      | 含义为某实体所能赋予的最大值       |
  | cnt      | 一个运行中的计数变量的当前值       |
  | key      | 键值       |

  例如:
  > get_retry_max() 表示取得最多重试的次数，  
  > get_retry_cnt() 表示取得当前重试的次数；  

  有时前缀是有用的:  

  | 前缀编码    | 说明     |
  | :------------- | :------------- |
  | is      | 含义为判断一个实例是否存在或者满足某一条件；       |
  | get      | 含义为取得某一实例变量的值；       |
  | set      | 含义为设定某一变量实例的值；       |

  例如:
  >is_hit_retry_limit();    
  >get_hit_cnt();    
  >set_class_value();    

***常用动词一览表***

| 动词名   | 说明     |
| :------------- | :------------- |
| is       | 是否存在或者满足某一条件       |
| get       | 取得某一实例变量的值       |
| set       | 设定某一变量实例的值       |
| load       | 加载某一对象/数据等       |
| has       | 和is类似，是否含有，拥有的意思       |
| save       | 保存某一对象/数据等       |
| update       | 和save类似，意思更具体,更新       |
| add       | 添加       |
| del       | 删除       |
| push       | 和 add 类似，多用于数组、堆的添加       |
| pop       | 和 del 类似，多用于数组、堆的添加       |
| check       | 检测       |
| cacl       | 计算       |
| parse       | 解析,多用于某一固定格式数据的分解到数组中的情况       |
| join       | 拼接，多用于字符串、数组的组合       |
| send       | 数据发送，多用于网络链接       |
| rec       | 数据接收，多用于网络链接      |

## 类的命名规则
1. **类名称的命名规则**
  类的名称采用Pascal(帕斯卡)命名法:大小写混合的方式来命名，名称的第一个单词的第一个字母必须大写，其后每个单词的第一个字母大写，例如:
  ```php
  Class MyClassExample
  {
  }
  ```

1. **类属性的命名规则**
  类的私有变量(不打算让外部直接调用的)采用以“_”为前缀，全局变量采用“m_”为前缀,后面的命名规则，【参看2-3】 函数变量命名，例如:
  ```php
  Class MyClassExample
  {
      // 推荐以下定义方式
      private $_value;
      public $m_value;

      // 以下定义方式，不建议
      var $value;
  }
  ```
  类属性的读取、设置建议采用 get属性名,set属性名的方法来提供，但该规则不做强制要求。

1. **类方法的命名规则**    
  类方法的命名规则【参看3】. 函数名的命名规则

## 程序书写规则

该部分主要是定义PHP的程序代码的书写规则，具体规则如下:
1. **一维数组**
```php
$users_id = array('10001','10252','15024');//确定
```

1. **二维及以上数组**
```php
$user = array(
    'id' => '100001',
    'name' => 'tony',
    'email' => 'tony@iapp.hk',
);
```

1. **if 判断条件语句:**
```php
if (condition) {
		Statement;
		….
}
else
{
		Statement;
		…..
}
```

1. **switch 判断条件语句:**
```php
switch (value) {
    case 1:
        ...
        break;
    default:
        ...
        break;
}
```


缩进排板以4个空格为一个单位，可以利用开发工具的TAB键替换功能；

## 常用技巧
##### HTTP协议缓存：
1. 文章使用Last Modified表示最后修改时间，不禁止缓存。
```php
header('Last Modified:Sat, 30 Oct 2010 13:21:21 GMT');
```

1. 需要用户登录的页面，禁止缓存。
```php
header('Cache-Control:max-age=0');
header('Cache-Control:private');
```

##### HTTP协议编码与mime：
1. HTTP输出一定要声明编码与mime。charset与分号之间要有一个空格。是大写UTF-8。比如
```php
header('Content-Type:application/json; charset=UTF-8');
header('Content-Type:application/xml; charset=UTF-8');
header('Content-Type:application/xhtml+xml; charset=UTF-8');
header('Content-Type:text/plain; charset=UTF-8');
header('Content-Type:text/html; charset=UTF-8');
```
