# 消息队列Amqp
> 维护人员: Tony Wang    
> 创建时间: 2016-12-06

## 概述
### 什么是AMQP
AMQP，即Advanced Message Queuing Protocol,一个提供统一消息服务的应用层标准高级消息队列协议,是应用层协议的一个开放标准,为面向消息的中间件设计。基于此协议的客户端与消息中间件可传递消息，并不受客户端/中间件不同产品，不同的开发语言等条件的限制。Erlang中的实现有 RabbitMQ等。

### RabbitMQ

我们选用的就是 RabbitMQ

>正式环境
http://amqp.soolife.net:15672

>测试环境
http://172.16.1.20:15672

## 交换机定义
| 交换机名称     | 类型     | 能接受的Key     | 解释说明     |
| :------------- | :------------- |:------------- |:------------- |
| lf.orders      | topic     |       | 本地生活订单消息       |
| sl.data      | topic     |         | 数据更新消息       |
| sl.member      | topic     |       | 会员注册与变更消息       |
| sl.orders      | topic     |       | 商品订单消息       |
| sl.trace      | topic     |       | 数据采集消息       |

<table >
  <tr>
    <td>www</td>
    <td>www</td>
    <td>www</td>
  </tr>
</table>

#### 本地生活 lf.orders
1. 会员注册消息定义
```json
{
  "member_id":100001,
  "type":"register"
}
```

1. 订单消息定义
```json
{
  "orders_id":1234567,
  "orders_no":"2016029282726182",
  "type":"pay",
  "create_time":191928282
}
```


## 队列定义
| 交换机名称     | 类型         | 说明     |
| :------------- | :-------------: |:------------- |
| sl.cid.cache      | Durable     | 缓存处理队列      |
| sl.cid.email      | Durable     | 邮件处理队列      |
| sl.cid.internal.message      | Durable     | 内部消息队列       |
| sl.cid.reward      | Durable     | 红包奖励队列      |
| sl.cid.sms      | Durable     | 短信处理队列      |
| sl.cid.trace.app      | Durable     | APP采集处理队列      |
| sl.cid.trace.download      | Durable     | APP下载采集队列      |
| sl.cid.trace.page      | Durable     | APP页面访问采集队列      |
