# 工作流引擎
> 维护人员: 汪肄敏    
> 创建时间: 2017-01-11  

[TOC]

　　工作流引擎，主要是实现业务流程的规则抽象，模型的建立，解释，以及为流程实例提供运行环境，并解释执行流程实例。    
　　工作流引擎必须要包含一个工作流模型的设计，工作流模型就是对业务流程抽象的一个模型，是整个工作流引擎的基础。所以模型设计的好坏决定引擎的功能是否灵活，也决定了工作流管理系统从设计实现到运行实施等诸多环节。

## 工作流引擎的基本元素：
### 步骤（step）
> 一个step描述的是工作流所处的位置。可能从一个step transtion到另外一个step，或者也可以在同一个step内流转（因为step可以通Status来细分，形成多个state）。一个流程里面可以有多个step。

### 状态（status）
> 状态status 是用来描述工作流程中具体step（步骤）状态的字符串。eWorkFlow中预置了三种步骤的状态 Underway（进行中）、Queued（等候处理中）、Finished（完成），用户可以任意扩展自己的状态。而工作流的状态state则是由step（步骤）＋status(步骤的状态)组成的。工作流状态state的升迁来达到工作流实例的推进。

### 流转（transtion）
> 一个工作流实例状态state到另一个状态state的转移。

### 动作（action）
> action 触发了发生在 step 内或 step 间的流转，或者说是基于 state 的流转。一个 step 里面可以有多个action。action 和step 之间的关系是，step 说明“在哪里”，action 说明“去哪里”。 一个 action 典型地由两部分组成：可以执行此action（动作）的condition（条件），以及执行此动作后的 result（结果）。   

### 任务（task）
> 任务是当工作流状态发生转移的时候，产生的任务。任务可以指定为一个具体的角色，人，或者群组。任务具体，待办，已办，竞争办理，代理待办等多种功能。

### 条件（condition）
> 类似于逻辑判断，可包含“AND”和“OR”逻辑。比如一个请假流程中的“本部门审批阶段”，该阶段利用“AND”逻辑，判断流程状态是否为等候处理中，以及审批者是否为本部门主管。


### 结果（result）
> Result 代表执行action（动作）后的结果，指向新的 step 及其 step status，也可能进入 split 或者 join。result 分为两种， contidional-result （有条件结果），只有条件为真时才使用该结果，和 unconditional-result（无条件结果），当条件不满足或没有条件时使用该结果。

### 分支/合并（split/join）
> 流程的分支和合并。分支是指流程下一步可以同时分发给多个步骤，分支split 提供多个unconditional-result（无条件结果）；join 则判断多个current step 的状态提供一个 result（结果）。


### 子流程（subflow）
> 子流程，动作的结果可以指向一个子流程，子流程是一个独立的流程，可以单独启动也可以嵌套在另外的流程中启动，和主流程有同步或异步衔接的属性。

### 自由流 （free transtion)
> 自由流是指当一个步骤的动作执行完成后，需要跳转到任务的步骤。任意步骤，是指整个流程范围内的任意步骤，包含执行过的或未执行过的。

### 回退流（return transtion）
> 回退指当流程实例运行到某个步骤的时候，由于某些特殊原因需要回退到已经执行过的某个步骤上。回退是一种特殊的过程，只有在运行过程中才会明确指导要回退到那个步骤，回退往往需要执行业务补偿。回退和自由流不一样，会退会摸掉当前步骤到回退步骤之间的运行轨迹，就像初次运行到回退的步骤一样，同时需要辅助业务补偿来到达业务数据的回退。



## 修订记录

| 版本   | 日期         | 说明   | 修订人  |
| ---- | ---------- | ---- | ---- |
| 0.1  | 2017-01-11 | 初版   | 汪肄敏  |
