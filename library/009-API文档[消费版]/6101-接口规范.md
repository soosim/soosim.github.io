# 接口规范 REST API
>创建人员：**Tony Wang**   
>创建时间：2016-12-06

## REST API 基本约束
1. 所有API接口均使用HTTP/HTTPS协议，请求的头信息中必须包含以下字段：
> - Authorization：请求用户名与密码（注：用户名=>AppID 密码=>AppKey）基本的Base64编码即可
>    + AppID：应用编号
>    + AppKey：加密字符串
> - Token：认证token （获取会员接口，必须登录后，才能获取）
> - Content-Type：application/json（附件上传接口除外）
> - Accept: 支持application/json 与application/xml,纯文本，返回JSON （如果不注明，将返回JSON）
> - User-Agent：客户端信息,代理需要转发客户端的信息

1. API 被设计为符合 HTTP, REST 规范。例如：查询请求使用 Get 方法，提交请求使用 Post 方法。如果一个请求不是相应的 HTTP 方法，将返回错误。
2. 如无特殊说明，调用参数值应转码为：UTF-8, URL编码。
3. API 请求有频率限制。
4. API 请求有黑名单机制。
5. 如需要启用压缩，则使用标准的Accept-Encoding头信息指定gzip压缩方式。
请求URL说明：

  > 协议://域名或IP地址:端口/版本/接口地址 （注：协议是http或https, 端口默认是80）

  > 举个栗子： http://api.soolife.cn:8090/v1/goods/10026 获取商品详细资料

---
## 数据开放层级Access:
| Code |	描述  |	详细解释 |
|:-----|:------|:--------|
| System | 系统层级 | 主要授权给平台、内部系统及线下系统使用 |
| DataPlatform | 平台层级 | 主要授权平台管理系统使用 |
| Partners | 合作伙伴层级 | 主要授权给合作的商家调用 |
| Open | 开放层级 | 主要授权给所有对象，只要有AppID与AppKey|

权限优先级如下： System > DataPlatform > Partners > Open

## HTTP方法
| 方法    | 数据处理     | 说明     |
| :------------- | :------------- |:------------- |
| GET     | Read     | 取得一个资源 |
| POST     | Create     | 新增一个没有id的资源 |
| PUT     | Update     | 更新一个资源。或新增一个含 id 资源(如果 id 不存在) |
| DELETE     | Delete     | 删除一个资源 |

## 鉴权方式
REST API 采用 HTTP基本认证的验证方式。
基本作法为，HTTP Header（头）里加 Authorization：

> Authorization: Basic ${base64_auth_string}

Header 名称是 "Authorization"，值是 base64 转换过的 "username:password" 对（中间有个冒号）。在API的场景里，username 是 app-id，密码是 api-key。

### 鉴权举例
你的 appKey 是 "7d431e42dfa6a6d693ac2d04", masterSecret 是 "5e987ac6d2e04d95a9d8f0d1"，则调用API时，使用 curl 命令的话，是这样写：

>curl --insecure -X POST -v http://v1.api.spplife.cn -H "Content-Type: application/json"
>-u "7d431e42dfa6a6d693ac2d04:5e987ac6d2e04d95a9d8f0d1"
>-d  '{"platform":"all","audience":"all","notification":{"alert":"Hi,JPush!"}}'

***HTTP 请求发出的请求是：***
> POST /v3/push HTTP/1.1
> Authorization: Basic N2Q0MzFlNDJkZmE2YTZkNjkzYWMyZDA0OjVlOTg3YWM2ZDJlMDRkOTVhOWQ4ZjBkMQ==

## API 频率控制
API 对访问次数，具有频率控制。即一定的时间窗口内，API 允许调用的次数是有限制的

## API 黑名单
如果某应用被认为是恶意推送，或者其 API 调用非法，其 AppKey 会被加入黑名单。
加入黑名单的 AppKey 的 API 调用，都会被直接拒绝，其返回码为 403（请求被拒绝）。返回内容格式为：
```javascript
{
  "error": {
       "code": 2003,
       "message": "The appKey is in black list."
   }
}
```

## REST是什么？

>REST ( REpresentational State Transfer )，State Transfer 为 "状态传输" 或 "状态转移 "，Representational 中文有人翻译为"表征"、"具象"，合起来就是 "表征状态传输" 或 "具象状态传输" 或 "表述性状态转移"，不过，一般文章或技术文件都比较不会使用翻译后的中文来撰写，而是直接引用 REST 或 RESTful 来代表，因为 REST 一整个观念，想要只用六个中文字来完整表达真有难度。
